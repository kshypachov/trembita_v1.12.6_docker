{{- define "trembita-1.12.6-ss.initContainers" }}
initContainers:
  {{- range $name, $cfg := .Values.persistentVolumes }}
  {{- if $cfg.enabled }}
  - name: init-copy-{{ $name }}
    image: {{ $.Values.image.repository }}:{{ $.Values.image.tag | default $.Chart.AppVersion }}
    command: ["/bin/sh", "-c"]
    args:
      - "cp -a {{ $cfg.mountPath }}/. /mnt/target/ && chown -R {{ $cfg.uid }}:{{ $cfg.gid }} /mnt/target || true"
    volumeMounts:
      - name: {{ $name }}
        mountPath: /mnt/target
  {{- end }}
  {{- end }}
{{- end }}